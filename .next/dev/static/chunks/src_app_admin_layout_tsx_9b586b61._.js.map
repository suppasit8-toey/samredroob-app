{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suppa/OneDrive/SAMREDROOB_APP/src/app/admin/layout.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createClientComponentClient } from \"@supabase/auth-helpers-nextjs\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from 'next/link';\r\nimport { LayoutDashboard, Package, Calculator, LogOut, Home } from 'lucide-react';\r\n\r\n// รายชื่ออีเมลที่เป็น Admin (Hardcoded for simplicity first)\r\nconst ADMIN_EMAILS = [\r\n    \"suppa@samredroob.com\",\r\n    \"admin@samredroob.com\",\r\n    // Add your email here to test\r\n];\r\n\r\nexport default function AdminLayout({\r\n    children,\r\n}: {\r\n    children: React.ReactNode;\r\n}) {\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n    const supabase = createClientComponentClient();\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Allow access to login page without auth\r\n    if (pathname === \"/admin/login\") {\r\n        return <>{children}</>;\r\n    }\r\n\r\n    useEffect(() => {\r\n        const checkUser = async () => {\r\n            const { data: { session } } = await supabase.auth.getSession();\r\n\r\n            if (!session) {\r\n                router.push(\"/admin/login\");\r\n                return;\r\n            }\r\n\r\n            // Check if user is admin (Optional: Uncomment to enforce strict email check)\r\n            // if (!ADMIN_EMAILS.includes(session.user.email || '')) {\r\n            //   alert(\"Unauthorized access\");\r\n            //   await supabase.auth.signOut();\r\n            //   router.push(\"/\");\r\n            //   return;\r\n            // }\r\n\r\n            setLoading(false);\r\n        };\r\n\r\n        checkUser();\r\n    }, [router, supabase]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-gray-50\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-black mx-auto mb-4\"></div>\r\n                    <p className=\"text-gray-500\">กำลังตรวจสอบสิทธิ์...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const handleSignOut = async () => {\r\n        await supabase.auth.signOut();\r\n        router.push(\"/admin/login\");\r\n    };\r\n\r\n    const navItems = [\r\n        { name: 'ภาพรวม', href: '/admin', icon: <LayoutDashboard size={20} /> },\r\n        { name: 'จัดการสินค้า', href: '/admin/products', icon: <Package size={20} /> },\r\n        { name: 'ตั้งค่าราคา', href: '/admin/pricing', icon: <Calculator size={20} /> },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"flex h-screen bg-gray-100\">\r\n            {/* Sidebar */}\r\n            <aside className=\"w-64 bg-white shadow-md flex flex-col z-10\">\r\n                <div className=\"p-6 border-b border-gray-100 flex items-center gap-3\">\r\n                    <div className=\"w-8 h-8 bg-black rounded-lg flex items-center justify-center text-white font-bold\">A</div>\r\n                    <span className=\"font-bold text-lg\">Admin Panel</span>\r\n                </div>\r\n\r\n                <nav className=\"flex-1 p-4 space-y-1\">\r\n                    {navItems.map((item) => {\r\n                        const isActive = pathname === item.href;\r\n                        return (\r\n                            <Link\r\n                                key={item.href}\r\n                                href={item.href}\r\n                                className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${isActive\r\n                                        ? \"bg-black text-white shadow-sm\"\r\n                                        : \"text-gray-600 hover:bg-gray-50 hover:text-black\"\r\n                                    }`}\r\n                            >\r\n                                {item.icon}\r\n                                <span className=\"font-medium\">{item.name}</span>\r\n                            </Link>\r\n                        );\r\n                    })}\r\n\r\n                    <div className=\"my-4 border-t border-gray-100 pt-4\">\r\n                        <Link\r\n                            href=\"/\"\r\n                            className=\"flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-black transition-colors\"\r\n                            target=\"_blank\"\r\n                        >\r\n                            <Home size={20} />\r\n                            <span className=\"font-medium\">ไปที่หน้าเว็บไซต์</span>\r\n                        </Link>\r\n                    </div>\r\n                </nav>\r\n\r\n                <div className=\"p-4 border-t border-gray-100\">\r\n                    <button\r\n                        onClick={handleSignOut}\r\n                        className=\"flex items-center gap-3 px-4 py-3 w-full rounded-lg text-red-600 hover:bg-red-50 transition-colors\"\r\n                    >\r\n                        <LogOut size={20} />\r\n                        <span className=\"font-medium\">ออกจากระบบ</span>\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex-1 overflow-auto\">\r\n                <header className=\"bg-white shadow-sm px-8 py-4 sticky top-0 z-0 flex justify-between items-center\">\r\n                    <h2 className=\"text-xl font-bold text-gray-800\">\r\n                        {navItems.find(i => i.href === pathname)?.name || 'Dashboard'}\r\n                    </h2>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"w-2 h-2 rounded-full bg-green-500\"></span>\r\n                        <span className=\"text-sm text-gray-500\">Online</span>\r\n                    </div>\r\n                </header>\r\n                <div className=\"p-8\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}