{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suppa/OneDrive/SAMREDROOB_APP/src/lib/supabase.ts"],"sourcesContent":["\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\n// Only create the client if the environment variables are available to avoid build errors during setup\r\nexport const supabase = (supabaseUrl && supabaseKey)\r\n    ? createClient(supabaseUrl, supabaseKey)\r\n    : null;\r\n"],"names":[],"mappings":";;;;AACA;;AAEA,MAAM;AACN,MAAM;AAGC,MAAM,WAAW,uCAClB,IAAA,8LAAY,EAAC,aAAa,eAC1B"}},
    {"offset": {"line": 17, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Suppa/OneDrive/SAMREDROOB_APP/src/app/admin/layout.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { supabase } from \"@/lib/supabase\";\r\nimport { useRouter, usePathname } from \"next/navigation\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from 'next/link';\r\nimport { LayoutDashboard, Package, Calculator, LogOut, Home } from 'lucide-react';\r\n\r\n// รายชื่ออีเมลที่เป็น Admin (Hardcoded for simplicity first)\r\nconst ADMIN_EMAILS = [\r\n    \"suppa@samredroob.com\",\r\n    \"admin@samredroob.com\",\r\n    // Add your email here to test\r\n];\r\n\r\nexport default function AdminLayout({\r\n    children,\r\n}: {\r\n    children: React.ReactNode;\r\n}) {\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const checkUser = async () => {\r\n            // Logic for non-login pages\r\n            if (pathname !== \"/admin/login\") {\r\n                // If supabase client failed to initialize\r\n                if (!supabase) {\r\n                    console.error(\"Supabase client not initialized\");\r\n                    setLoading(false);\r\n                    return;\r\n                }\r\n\r\n                const { data: { session } } = await supabase.auth.getSession();\r\n\r\n                if (!session) {\r\n                    router.push(\"/admin/login\");\r\n                    return;\r\n                }\r\n\r\n                // Check if user is admin (Optional)\r\n                // if (!ADMIN_EMAILS.includes(session.user.email || '')) { ... }\r\n\r\n                setLoading(false);\r\n            } else {\r\n                // If on login page, verify if we are ALREADY logged in\r\n                if (supabase) {\r\n                    const { data: { session } } = await supabase.auth.getSession();\r\n                    if (session) {\r\n                        router.push(\"/admin\"); // Redirect to dashboard if already logged in\r\n                    }\r\n                }\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        checkUser();\r\n    }, [router, pathname]);\r\n\r\n    // Handle Login Page Rendering specially (No Sidebar)\r\n    if (pathname === \"/admin/login\") {\r\n        // We can just return children here. \r\n        // The useEffect will handle redirecting AWAY if already logged in.\r\n        return <>{children}</>;\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex h-screen items-center justify-center bg-gray-50\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-black mx-auto mb-4\"></div>\r\n                    <p className=\"text-gray-500\">กำลังตรวจสอบสิทธิ์...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const handleSignOut = async () => {\r\n        if (supabase) {\r\n            await supabase.auth.signOut();\r\n        }\r\n        router.push(\"/admin/login\");\r\n    };\r\n\r\n    const navItems = [\r\n        { name: 'ภาพรวม', href: '/admin', icon: <LayoutDashboard size={20} /> },\r\n        { name: 'จัดการสินค้า', href: '/admin/products', icon: <Package size={20} /> },\r\n        { name: 'ตั้งค่าราคา', href: '/admin/pricing', icon: <Calculator size={20} /> },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"flex h-screen bg-gray-100\">\r\n            {/* Sidebar */}\r\n            <aside className=\"w-64 bg-white shadow-md flex flex-col z-10\">\r\n                <div className=\"p-6 border-b border-gray-100 flex items-center gap-3\">\r\n                    <div className=\"w-8 h-8 bg-black rounded-lg flex items-center justify-center text-white font-bold\">A</div>\r\n                    <span className=\"font-bold text-lg\">Admin Panel</span>\r\n                </div>\r\n\r\n                <nav className=\"flex-1 p-4 space-y-1\">\r\n                    {navItems.map((item) => {\r\n                        const isActive = pathname === item.href;\r\n                        return (\r\n                            <Link\r\n                                key={item.href}\r\n                                href={item.href}\r\n                                className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${isActive\r\n                                        ? \"bg-black text-white shadow-sm\"\r\n                                        : \"text-gray-600 hover:bg-gray-50 hover:text-black\"\r\n                                    }`}\r\n                            >\r\n                                {item.icon}\r\n                                <span className=\"font-medium\">{item.name}</span>\r\n                            </Link>\r\n                        );\r\n                    })}\r\n\r\n                    <div className=\"my-4 border-t border-gray-100 pt-4\">\r\n                        <Link\r\n                            href=\"/\"\r\n                            className=\"flex items-center gap-3 px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-black transition-colors\"\r\n                            target=\"_blank\"\r\n                        >\r\n                            <Home size={20} />\r\n                            <span className=\"font-medium\">ไปที่หน้าเว็บไซต์</span>\r\n                        </Link>\r\n                    </div>\r\n                </nav>\r\n\r\n                <div className=\"p-4 border-t border-gray-100\">\r\n                    <button\r\n                        onClick={handleSignOut}\r\n                        className=\"flex items-center gap-3 px-4 py-3 w-full rounded-lg text-red-600 hover:bg-red-50 transition-colors\"\r\n                    >\r\n                        <LogOut size={20} />\r\n                        <span className=\"font-medium\">ออกจากระบบ</span>\r\n                    </button>\r\n                </div>\r\n            </aside>\r\n\r\n            {/* Main Content */}\r\n            <main className=\"flex-1 overflow-auto\">\r\n                <header className=\"bg-white shadow-sm px-8 py-4 sticky top-0 z-0 flex justify-between items-center\">\r\n                    <h2 className=\"text-xl font-bold text-gray-800\">\r\n                        {navItems.find(i => i.href === pathname)?.name || 'Dashboard'}\r\n                    </h2>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <span className=\"w-2 h-2 rounded-full bg-green-500\"></span>\r\n                        <span className=\"text-sm text-gray-500\">Online</span>\r\n                    </div>\r\n                </header>\r\n                <div className=\"p-8\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}